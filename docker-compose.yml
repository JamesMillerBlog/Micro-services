version: "3"
services:
  nginx:
    build: ./web/nginx
    ports:
      - "80:80"
    depends_on:
      - home-app
      - accounts-api
  home-app:
    build: ./web/home/app
    volumes:
      - "./web/home/app:/usr/src/app"
    # env_file: .env
    ports:
      - "4000:4000"
    command: gulp
  accounts-api:
    build: ./web/accounts/api
    volumes:
      - "./web/accounts/api:/usr/src/app"
    depends_on:
      - accounts-db
    command: npm start
  accounts-db:
    image: mongo:latest
    volumes:
      - "./web/accounts/mongo/data/db:/data/db/"
  # redis:
  #   image: "redis:alpine"

  # command: bash -c "npm update && npm install"
    

  # to start: docker-compose up

  # Docker Commands:
    # command: node ./dist/index.js
    # docker stop $(docker ps -a -q)
    # docker rm $(docker ps -a -q)
    # docker rmi $(docker images -a -q)


